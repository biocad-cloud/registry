RewriteEngine On

# --- 以下是你原有的 Header 配置 (保持不变) ---
Header set Access-Control-Allow-Origin "*"

# cache images for 1 month, do not require revalidation
<FilesMatch "\.(gif|jpe?g|png|flv|swf|ico)$">
Header set Cache-Control: "max-age=1296000"
</FilesMatch>
#
# cache scripts, css, and documents for 1 week, do not require revalidation
<FilesMatch "\.(js|css|pdf)$">
Header set Cache-Control: "max-age=10800"
</FilesMatch>
#
# Cache txt, html, and htm pages for 1 week, require revalidation
<FilesMatch "\.(txt|html?)$">
Header set Cache-Control: "max-age=604800, must-revalidate"
</FilesMatch>
#
# disable caching for dynamic files
<FilesMatch "\.(pl|php|[sf]?cgi|spl)$">
Header set Cache-Control: "max-age=0, no-store"
</FilesMatch>
# --- Header 配置结束 ---

RewriteCond %{REQUEST_URI} !^/index\.php

# 1. 如果请求的是一个真实存在的文件（例如 index.php, logo.png），直接跳过重写
RewriteCond %{REQUEST_FILENAME} !-f
# 2. 如果请求的是一个真实存在的目录，直接跳过重写
RewriteCond %{REQUEST_FILENAME} !-d

# 3. 处理带斜杠的请求 (例如 /home/ ) -> 去掉斜杠传给 app
RewriteRule ^(.+)/$ /index.php?app=$1 [L]

# 4. 处理普通请求 (例如 /home ) -> 传给 app
# 注意：这里加了 [L] 表示匹配后立即停止，不再往下匹配
RewriteRule ^(.+)$ /index.php?app=$1 [L]
